#!/bin/bash

trap "echo -e '\nCaught ^C from user - exiting now' ; exit 130" SIGINT

eval_brew() {
  if [[ -x "/opt/homebrew/bin/brew" ]]; then
    eval "$(/opt/homebrew/bin/brew shellenv)"
  elif [[ -x "/usr/local/bin/brew" ]]; then
    eval "$(/usr/local/bin/brew shellenv)"
  elif [[ -x "/home/linuxbrew/.linuxbrew/bin/brew" ]]; then
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
  elif [[ -x "$HOME/.linuxbrew/bin/brew" ]]; then
    eval "$("$HOME"/.linuxbrew/bin/brew shellenv)"
  fi
}
eval_brew

if ! command -v brew >/dev/null; then
  NONINTERACTIVE=true HOMEBREW_INSTALL_FROM_API=true \
    bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
  eval_brew
fi

### linters ####################################################################

brew install hadolint   # haskell
brew install shellcheck # haskell

### scanners ###################################################################

brew install trivy # go

### docker #####################################################################

if [[ $OSTYPE == darwin* ]]; then
  brew install lima # go
else
  brew install ctop # go
fi

### network ####################################################################

brew install dog  # rust
brew install k6   # go
brew install nmap # c
brew install oha  # rust

### aws ########################################################################

brew install aws-vault # go

### azure ######################################################################

brew install azcopy # go

### k8s ########################################################################

brew install kubernetes-cli # go
brew install kubectx        # go
brew install helm           # go
brew install k9s            # go

### terraform ##################################################################

brew install tfenv # bash
tfenv install latest
tfenv use latest

brew install tfsec                # go
brew install shihanng/tfvar/tfvar # go
