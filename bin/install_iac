#!/bin/bash

trap "echo -e '\nCaught ^C from user - exiting now' ; exit 130" SIGINT

eval_brew() {
  if [[ -x "/opt/homebrew/bin/brew" ]]; then
    eval "$(/opt/homebrew/bin/brew shellenv)"
  elif [[ -x "/usr/local/bin/brew" ]]; then
    eval "$(/usr/local/bin/brew shellenv)"
  elif [[ -x "/home/linuxbrew/.linuxbrew/bin/brew" ]]; then
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
  elif [[ -x "$HOME/.linuxbrew/bin/brew" ]]; then
    eval "$("$HOME"/.linuxbrew/bin/brew shellenv)"
  fi
}
eval_brew

if ! which brew &>/dev/null; then
  NONINTERACTIVE=true bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
  eval_brew
fi

### linters ####################################################################

brew install shellcheck

### docker #####################################################################

[[ $OSTYPE == darwin* ]] && brew install lima

### network ####################################################################

brew install dog
brew install k6
brew install nmap
brew install oha

### azure ######################################################################

brew install azure-cli
az config set core.collect_telemetry=false
az config set core.output=jsonc

az extension add --name azure-devops --upgrade --yes
az extension add --name next --upgrade --yes

brew install azcopy

### k8s ########################################################################

brew install kubernetes-cli
brew install kubectx
brew install helm
brew install k9s

### terraform ##################################################################

brew install tfenv
tfenv install latest
tfenv use latest

brew install tfsec
brew install shihanng/tfvar/tfvar
