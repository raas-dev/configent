#!/bin/sh

session_name="$(basename "$PWD")"

while getopts "s:" opt; do
  case $opt in
  s) session_name="$OPTARG" ;;
  *)
    echo "Usage: $0 [-s session_name]" >&2
    exit 1
    ;;
  esac
done

shift $((OPTIND - 1))

if tmux has-session -t "$session_name" 2>/dev/null; then
  if [ $# -gt 0 ]; then
    exec tmux new-window -t "$session_name" "$@" \; attach-session -t "$session_name"
  else
    exec tmux attach-session -t "$session_name"
  fi
else
  exec tmux new-session -s "$session_name" "$@"
fi
